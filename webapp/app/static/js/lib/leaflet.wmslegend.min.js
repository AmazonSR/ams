L.Control.WMSLegend=L.Control.extend({options:{position:'middleright',uri:'',static:{deter:{url:''},af:{url:''},risk:{url:''}}},onAdd:function(){let d='leaflet-control-wms-legend',b='wms-legend';this.fcontainer=L.DomUtil.create('div','leaflet-control-legend'),this.ll=L.DomUtil.create('span','label-legend',this.fcontainer),this.ll.innerText='LEGENDA';let a=L.DomUtil.create('div',d,this.fcontainer);this.options.static.deter.url&&this.createLegendImage(a,'DETER','DETER Legend',b,this.options.static.deter.url),this.options.static.af.url&&this.createLegendImage(a,'Focos de Queimadas','Active Fires Legend',b,this.options.static.af.url),this.options.static.risk.url&&this.createLegendImage(a,'Risco de desmatamento (IBAMA)','IBAMA Risk Legend',b,this.options.static.risk.url),this.img=this.createLegendImage(a,ams.Map.PopupControl._prefix+ams.Map.PopupControl._text,'Spatial Unit Legend',b,this.options.uri);let c=L.DomEvent.stopPropagation;return L.DomEvent.on(this.fcontainer,'click',this._click,this).on(this.ll,'click',this._click,this).on(this.img,'click',this._click,this).on(a,'click',this._click,this).on(this.img,'mousedown',c).on(this.img,'dblclick',c).on(this.img,'click',L.DomEvent.preventDefault).on(this.img,'click',c),this.height=null,this.width=null,this.container=a,this.fcontainer},_click:function(a){L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a);var b=window.getComputedStyle(this.container);b.display==='none'?(this.fcontainer.style.height=this.height+'px',this.fcontainer.style.width=this.width+'px',this.container.style.display=this.displayStyle,this.ll.style.display='none'):(this.width===null&&this.height===null&&(this.height=this.fcontainer.offsetHeight,this.width=this.fcontainer.offsetWidth),this.displayStyle=this.container.style.display,this.container.style.display='none',this.ll.style.display='inline',this.fcontainer.style.height='fit-content',this.fcontainer.style.width='20px')},createLegendImage:function(b,c,d,e,f){let g=L.DomUtil.create('span','wms-label-legend',b);g.innerText=c;let a=L.DomUtil.create('img',e,b);a.alt=d;const h={headers:{Authorization:"Bearer "+AuthenticationService.getToken()},credentials:'omit',cache:'no-cache'};return fetch(f,h).then(a=>a.blob()).then(b=>{a.src=URL.createObjectURL(b)}),a}}),L.wmsLegend=function(b){var a=new L.Control.WMSLegend;return a.options.uri=b,map.addControl(a),a}